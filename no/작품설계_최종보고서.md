## 1. 작품 설계: 안심톡(AnsimTalk)

### 설계 개념: 사용자가 주도하는 AI 기반 디지털 증거 분석 및 보호 시스템

**안심톡(AnsimTalk)**은 단순한 분석 도구를 넘어, 사용자가 디지털 환경에서 마주하는 위협(사이버폭력, 딥페이크 등)에 스스로 대처할 수 있는 역량을 강화하는 **자기주도형 디지털 안전망**을 지향합니다. 시스템은 사용자의 프라이버시와 자기결정권을 최우선 가치로 삼으며, AI 분석 결과를 기반으로 사용자가 직접 [증거 저장], [상담 연결], [신고], [무시] 등 다음 행동을 주체적으로 선택하도록 설계되었습니다.

#### 4대 설계 원칙

1.  **주체성 (Autonomy)**: 시스템은 분석 정보를 제공할 뿐, 판단을 강요하지 않습니다. 모든 결정의 주체는 사용자입니다.
2.  **프라이버시 (Privacy)**: 사용자가 명시적으로 '증거 저장'을 선택하기 전까지, 업로드된 파일은 서버에 영구 저장되지 않고 세션 종료 시 자동 파기됩니다.
3.  **증거력 (Evidentiary Value)**: 분석 결과, 원본 파일 정보, SHA-256 해시, 파일 메타데이터, 분석 과정(Chain of Custody)을 포함한 전문적인 PDF 증거 보고서를 생성하여, 법적 증거 능력을 극대화합니다.
4.  **투명성 (Transparency)**: 분석에 사용된 AI 모델, 버전, 분석 절차 등 모든 데이터 흐름을 명확하게 관리하고 증거 보고서에 명시하여 신뢰성을 확보합니다.

### 작동 원리: 실제 구현 기반 4단계 분석 파이프라인

1.  **입력 및 전처리 (Input & Pre-processing)**
    -   **파일 업로드**: 사용자가 웹 UI를 통해 분석할 파일(txt, png, jpg, jpeg)을 선택하고, 분석 유형(사이버폭력/딥페이크)을 지정합니다.
    -   **유효성 검증**: 서버(Flask)는 파일의 확장자, 크기(5MB 제한)를 검증합니다.
    -   **임시 저장 및 정보 추출**: 파일은 `tmp/` 폴더에 임시 저장되며, `app/static/uploads/`에 웹 표시용 사본이 저장됩니다. 동시에 Pillow 라이브러리를 사용하여 이미지 메타데이터(해상도 등)를 추출하고, `hashlib`을 통해 원본 파일의 SHA-256 해시값을 계산합니다.

2.  **AI 분석 (AI Analysis)**
    -   **분기 처리**: `services.py`는 사용자가 선택한 분석 유형에 따라 각기 다른 AI 파이프라인을 호출합니다.
    -   **사이버폭력 분석**:
        1.  **텍스트 추출 (OCR)**: 이미지 파일의 경우, Google Cloud Vision API가 이미지 내 텍스트를 추출합니다.
        2.  **내용 분석**: 추출된 텍스트(또는 txt 파일 내용)를 Google Gemini 모델로 전송하여, 폭력성, 유형(욕설, 비하, 따돌림 등), 가해자/피해자, 문장별 위험도를 분석하고, 그 결과를 구조화된 마크다운 표와 요약문으로 반환받습니다.
    -   **딥페이크 및 유해성 분석**:
        1.  **이미지 분석**: 이미지 파일을 Sightengine API로 전송하여 `deepfake`, `offensive`, `nudity` 등 여러 모델을 통해 딥페이크 확률 및 유해성 점수를 분석합니다.

3.  **증거화 및 시각화 (Evidentiary & Visualization)**
    -   **결과 통합**: 모든 분석 결과, 파일 정보, 메타데이터, 해시값 등은 Flask 세션에 안전하게 저장됩니다.
    -   **결과 시각화**: `results.html` 템플릿은 세션 데이터를 바탕으로 분석 결과를 사용자에게 명확하고 이해하기 쉽게 시각화하여 보여줍니다.
    -   **증거 보고서 생성**: 사용자가 '증거 저장'을 요청하면, `services.py`의 `generate_pdf_report` 함수가 호출됩니다. 이 함수는 WeasyPrint 라이브러리를 사용하여, 모든 증거 데이터를 담은 동적 HTML 템플릿(`generate_report_html`)을 전문적인 PDF 보고서로 렌더링합니다.

4.  **사용자 결정 및 후속 조치 (User Decision & Action)**
    -   **행동 선택**: 결과 페이지에서 사용자는 [증거 저장(PDF 다운로드)], [상담/신고 안내], [새로 시작] 등의 버튼을 통해 다음 행동을 선택합니다.
    -   **상담/신고 안내 시스템**: 사용자가 상담/신고 안내를 선택하면, 분석 유형에 따라 `deepfake_help.html` 또는 `cyberbullying_help.html` 페이지로 이동하여 기관별 상세 안내를 받을 수 있습니다.
    -   **세션 종료**: 사용자가 '새로 시작'을 선택하면, `reset` 라우트가 호출되어 관련 세션 데이터와 `tmp/`, `app/static/uploads/`에 저장된 임시 파일들을 모두 삭제하여 프라이버시를 보장합니다.

### 소프트웨어 아키텍처 및 보안

-   **소프트웨어 구조**: 모듈성과 확장성을 고려하여 설계되었습니다.
    -   **`routes.py`**: 웹 요청 처리, 파일 유효성 검증, 세션 관리 등 컨트롤러 역할
    -   **`services.py`**: 외부 AI API 연동, PDF 생성, 텍스트 추출 등 핵심 비즈니스 로직 처리
    -   **`templates/`**: Jinja2 템플릿을 사용하여 동적 웹페이지 생성
        -   `index.html`: 메인 페이지 (딥페이크/사이버폭력 분석 선택)
        -   `results.html`: 분석 결과 페이지 (버튼 UI 최적화 적용)
        -   `deepfake_help.html`: 딥페이크 상담/신고 안내 페이지
        -   `cyberbullying_help.html`: 사이버폭력 신고 안내 페이지
        -   `evidence_report.html`: PDF 증거 보고서 템플릿
    -   **`static/css/style.css`**: 메인 스타일시트 (버튼 텍스트 1줄 표시 최적화 포함)
-   **보안 및 개인정보 보호**:
    -   **임시 파일 관리**: 모든 업로드 파일은 명시적인 저장 요청 없이는 영구 저장되지 않으며, 세션 종료 시 파기됩니다.
    -   **증거 무결성**: SHA-256 해시값을 통해 증거의 위변조 방지를 보장합니다.
    -   **민감 정보 분리**: API 키 및 환경 설정은 `config.py`와 Google Cloud `*.json` 키 파일로 분리하고, `.gitignore`를 통해 버전 관리에서 제외하여 유출을 방지합니다.

## 2. 제작 현황 및 향후 계획

### 현재까지 완료된 핵심 기능 (As-is)

-   **파일 업로드 및 전처리**: 이미지(jpg, jpeg, png) 및 텍스트(txt) 파일 업로드, 확장자 및 용량(5MB) 검증, SHA-256 해시 생성, 이미지 메타데이터 추출 기능이 안정적으로 작동합니다.
-   **AI 분석 파이프라인**: Sightengine을 이용한 딥페이크/유해성 분석과 Google Vision OCR 및 Gemini를 이용한 사이버폭력 분석 기능이 완벽하게 통합 및 구현되었습니다.
-   **결과 시각화 및 증거화**: 분석 결과를 웹페이지에 동적으로 표시하고, WeasyPrint를 통해 모든 법적 요건(해시, 메타데이터, Chain of Custody 등)을 포함한 전문적인 PDF 증거 보고서를 생성 및 다운로드하는 기능이 완료되었습니다.
-   **사용자 주도 세션 관리**: 사용자가 분석을 종료하고 임시 파일과 세션 데이터를 직접 파기하는 기능이 구현되었습니다.
-   **보안 및 프라이버시**: `config.py` 및 `.gitignore`를 통한 민감 정보 분리, 임시 파일 관리 정책 등 기본적인 보안 조치가 적용되었습니다.
-   **상담/신고 안내 시스템**: 딥페이크와 사이버폭력 각각에 대한 전문적인 상담/신고 안내 페이지가 구현되었으며, 기관별 공식 링크로 직접 연결됩니다.
-   **UI/UX 개선**: 모든 버튼의 텍스트가 1줄에 표시되도록 CSS 최적화가 완료되었습니다.

### 최신 구현 완료 사항 (2024년 12월)

-   **상담/신고 안내 페이지 구현**:
    -   **딥페이크 피해 상담/신고 안내**: 기관별 도움 내용, 주의사항, 상황별 추천, 연락처 및 공식 링크를 포함한 종합 안내 페이지
    -   **사이버폭력 신고 안내**: 1388 청소년 상담복지센터(채팅 상담), 117 학교폭력 신고센터, 경찰청 사이버범죄 신고시스템(ECRM) 등 기관별 상세 안내
    -   각 기관의 공식 홈페이지로 직접 연결되는 링크 제공으로 신속한 대응 지원
-   **버튼 UI 최적화**: 모든 버튼의 텍스트가 1줄에 표시되도록 CSS `white-space: nowrap` 속성 적용
-   **사이버폭력 분석 결과 표시 개선**: 웹에서도 상세 분석 결과가 항상 표시되도록 개선
-   **사용자 경험 향상**: 메인 페이지에서 각 분석 유형별 상담/신고 안내 페이지로의 직관적인 연결

### 향후 개선 및 확장 계획 (To-be)

-   **기능 고도화**:
    -   **증거 관리 시스템**: 생성된 증거 보고서를 사용자 계정별로 DB에 저장하고, 이력을 관리하며 검색할 수 있는 기능 추가.
    -   **실시간 알림**: 분석 완료 또는 위험 탐지 시 이메일, SMS 등 실시간 알림 기능 연동.
    -   **관리자 대시보드**: 서비스 운영 현황, 분석 통계, 위험 패턴 등을 모니터링할 수 있는 관리자 페이지 개발.
-   **사용자 경험(UX) 개선**:
    -   **다국어 지원**: 한국어 외 영어, 일본어 등 다국어 UI/UX 지원.
    -   **웹 접근성**: 스크린 리더 사용자 등을 위한 웹 접근성 표준 준수.
    -   **모바일 최적화**: 모바일 기기에서의 사용성을 더욱 향상시키는 반응형 디자인 개선.
-   **보안 강화**:
    -   **HTTPS 적용**: 모든 통신 구간을 SSL/TLS로 암호화.
    -   **인증 및 인가**: 사용자 회원가입 및 로그인 기능을 도입하여 개인화된 서비스 제공 및 접근 제어 강화 (e.g., Google Firebase, OAuth 2.0).
-   **배포 및 운영**:
    -   **클라우드 배포**: Docker 컨테이너화 및 GCP, AWS 등 클라우드 환경에 배포하여 안정적인 서비스 운영.
    -   **CI/CD 파이프라인**: Git 커밋 시 자동으로 테스트, 빌드, 배포가 이루어지는 CI/CD 파이프라인 구축.